<?xml version="1.0" encoding="UTF-8"?>
<?import javafx.geometry.*?>
<?import javafx.scene.canvas.Canvas?>
<?import javafx.scene.control.*?>
<?import javafx.scene.image.Image?>
<?import javafx.scene.image.ImageView?>
<?import javafx.scene.layout.*?>
<?import javafx.scene.shape.Circle?>

<BorderPane xmlns="http://javafx.com/javafx/23.0.1"
            xmlns:fx="http://javafx.com/fxml/1"
            fx:controller="com.shotvalue.analizador_xgot.controller.VisualizarController">

    <center>
        <VBox spacing="20" alignment="TOP_CENTER"
              style="-fx-background-color: #2E2E2E; -fx-padding: 30;" maxWidth="1200">

            <!-- FILTROS PRINCIPALES -->
            <GridPane hgap="15" vgap="10">
                <columnConstraints>
                    <ColumnConstraints percentWidth="16.6"/>
                    <ColumnConstraints percentWidth="16.6"/>
                    <ColumnConstraints percentWidth="16.6"/>
                    <ColumnConstraints percentWidth="16.6"/>
                    <ColumnConstraints percentWidth="16.6"/>
                    <ColumnConstraints percentWidth="16.6"/>
                </columnConstraints>
                <children>
                    <Label text="Período" textFill="white" GridPane.columnIndex="0"/>
                    <ComboBox fx:id="periodBox" promptText="Any" GridPane.columnIndex="0" GridPane.rowIndex="1"/>

                    <Label text="Minutos (desde/hasta)" textFill="white" GridPane.columnIndex="1"/>
                    <HBox spacing="5" GridPane.columnIndex="1" GridPane.rowIndex="1">
                        <children>
                            <Spinner fx:id="minuteFromSpinner" prefWidth="70"/>
                            <Label text="a" textFill="white"/>
                            <Spinner fx:id="minuteToSpinner" prefWidth="70"/>
                        </children>
                    </HBox>

                    <Label text="Local / Visitante" textFill="white" GridPane.columnIndex="2"/>
                    <ComboBox fx:id="teamSideBox" promptText="Any" GridPane.columnIndex="2" GridPane.rowIndex="1"/>

                    <Label text="Jugador" textFill="white" GridPane.columnIndex="3"/>
                    <TextField fx:id="playerSearchField" promptText="Buscar..." GridPane.columnIndex="3" GridPane.rowIndex="1"/>

                    <Label text="Tercio" textFill="white" GridPane.columnIndex="4"/>
                    <ComboBox fx:id="thirdBox" promptText="Any" GridPane.columnIndex="4" GridPane.rowIndex="1"/>

                    <Label text="Carril" textFill="white" GridPane.columnIndex="5"/>
                    <ComboBox fx:id="laneBox" promptText="Any" GridPane.columnIndex="5" GridPane.rowIndex="1"/>
                </children>
            </GridPane>

            <!-- TIPO DE VISUALIZACIÓN -->
            <HBox spacing="20" alignment="CENTER_LEFT">
                <Label text="Evento" textFill="white"/>
                <ComboBox fx:id="eventTypeBox" promptText="Shots"/>

                <Label text="Visualización" textFill="white"/>
                <ComboBox fx:id="visualizationTypeBox" promptText="Shot Map + GoalCrunch" prefWidth="200"/>

                <Button fx:id="applyFiltersBtn" text="Aplicar Filtros"
                        style="-fx-background-color: #4CAF50; -fx-text-fill: white;"/>
            </HBox>

            <!-- FILTROS Y GRÁFICOS -->
            <HBox spacing="30" alignment="TOP_CENTER">

                <!-- FILTROS -->
                <VBox spacing="15" prefWidth="240"
                      style="-fx-background-color: #1F1F1F; -fx-padding: 15;
                             -fx-border-color: #444; -fx-border-width: 1;">
                    <Label text="Filtros del evento"
                           style="-fx-text-fill: white; -fx-font-weight: bold; -fx-font-size: 14px;"/>
                    <Separator/>

                    <Label text="Área" textFill="white"/>
                    <ComboBox fx:id="areaBox" promptText="Any"/>

                    <Label text="Situación" textFill="white"/>
                    <ComboBox fx:id="situationBox" promptText="Any"/>

                    <Label text="Parte del cuerpo" textFill="white"/>
                    <ComboBox fx:id="bodyPartBox" promptText="Any"/>

                    <Label text="Acción previa" textFill="white"/>
                    <ComboBox fx:id="preActionBox" promptText="Any"/>

                    <Label text="Resultado" textFill="white"/>
                    <ComboBox fx:id="resultBox" promptText="Any"/>

                    <Label text="NPxG" textFill="white"/>
                    <TextField fx:id="xgField" promptText="0.00"/>
                </VBox>

                <!-- VISUALIZACIONES -->
                <VBox spacing="10" alignment="CENTER"
                      style="-fx-background-color: #1F1F1F; -fx-padding: 20;
                             -fx-border-color: #444; -fx-border-width: 1;">
                    <Label text="Visualizaciones"
                           style="-fx-text-fill: white; -fx-font-weight: bold; -fx-font-size: 14px;"/>
                    <HBox spacing="15" alignment="CENTER">
                        <Label text="Leyenda:" style="-fx-text-fill: white; -fx-font-weight: bold;"/>
                        <HBox spacing="5" alignment="CENTER">
                            <Circle radius="6" fill="LIMEGREEN"/>
                            <Label text="Gol" style="-fx-text-fill: white;"/>
                        </HBox>
                        <HBox spacing="5" alignment="CENTER">
                            <Circle radius="6" fill="GOLD"/>
                            <Label text="Atajado" style="-fx-text-fill: white;"/>
                        </HBox>
                        <HBox spacing="5" alignment="CENTER">
                            <Circle radius="6" fill="CRIMSON"/>
                            <Label text="Fuera" style="-fx-text-fill: white;"/>
                        </HBox>
                        <HBox spacing="5" alignment="CENTER">
                            <Circle radius="6" fill="ORANGE"/>
                            <Label text="Bloqueado" style="-fx-text-fill: white;"/>
                        </HBox>
                        <HBox spacing="5" alignment="CENTER">
                            <Circle radius="6" fill="WHITE" stroke="BLACK" strokeWidth="1"/>
                            <Label text="Otro" style="-fx-text-fill: white;"/>
                        </HBox>
                    </HBox>

                    <StackPane>
                        <ImageView fx:id="fieldMap" fitWidth="500" fitHeight="250" preserveRatio="true">
                            <image>
                                <Image url="@/img/field_placeholder.png"/>
                            </image>
                        </ImageView>
                        <Canvas fx:id="canvasTiros" width="500" height="250" />
                    </StackPane>

                    <StackPane>
                        <ImageView fx:id="goalView" fitWidth="500" fitHeight="150" preserveRatio="true">
                            <image>
                                <Image url="@/img/goal_placeholder.png"/>
                            </image>
                        </ImageView>
                        <Canvas fx:id="canvasArco" width="500" height="150" />
                    </StackPane>

                    <!-- NUEVA LEYENDA DEBAJO DEL ARCO -->
                    <HBox spacing="10" alignment="CENTER">
                        <Label text="Leyenda:" style="-fx-text-fill: white; -fx-font-weight: bold;"/>
                        <HBox spacing="5" alignment="CENTER">
                            <Circle radius="6" fill="LIMEGREEN"/>
                            <Label text="Gol" style="-fx-text-fill: white;"/>
                        </HBox>
                        <HBox spacing="5" alignment="CENTER">
                            <Circle radius="6" fill="GOLD"/>
                            <Label text="Atajado" style="-fx-text-fill: white;"/>
                        </HBox>
                        <HBox spacing="5" alignment="CENTER">
                            <Circle radius="6" fill="GRAY"/>
                            <Label text="Poste" style="-fx-text-fill: white;"/>
                        </HBox>
                    </HBox>

                </VBox>
            </HBox>
        </VBox>
    </center>
</BorderPane>
